# 其他操作符

## 条件操作符 ?:

条件操作符是JavaScript唯一一个三元操作符(有三个操作 数)，因此有时候也被叫作三元操作符。

条件操作符的操作数可以是任意类型。第一个操作数被求值并解释为一个布尔值。如果第一个操作数的值是真值，那么就求值第二个操作数，并返回它的值。否则，求值第三个操作数并返回它的值。第二个或第三个操作数只有一个会被求值，不可能两个都被求值。

## 先定义 ??

先定义(first-defined)操作符??求值其先定义的操作数，如 果其左操作数不是null或undefined，就返回该值。否则，它会返回 右操作数的值。与&&或||操作符类似，??是短路的:它只在第一个 操作数求值为null或undefined时才会求值第二个操作数。如果表达 式a没有副效应，那么表达式a ?? b等价于:

```js
(a !== null && a !== undefined) ? a : b
```

??是对||的一个有用的替代，适合选择先定 义的操作数，而不是第一个为真值的操作数。尽管||名义上是个逻 辑或操作符，习惯上也会使用它选择第一个非假值操作数，比如:

```js
//如果maxwidth是真值，就使用它；否则，看看preferences
//对象。如果preferences里也没有真值，就使用硬编码的常量
let max = maxwidth || preferences.maxWidth || 500;
```

这种习惯用法的问题在于，0、空字符串和false都是假值，但 这些值在某些情况下是完全有效的。对上面的代码示例来说， maxWidth如果等于0，该值就会被忽略。如果我们把||操作符改 为??，那么对这个表达式来说，0也会成为有效的值:

```js
//如果maxwidth是真值，就使用它；否则，看看preferences
//对象。如果preferences里也没有真值，就使用硬编码的常量
let max = maxwidth ?? preferences.maxWidth ?? 500;
```

下面再看几个例子，其中??的第一个操作数都是假值。如果这 个操作数是假值但有定义，??仍然返回这个值。只有当第一个操作 数“缺值”(nullish)时(即null或undefined)，这个操作符才 会求值并返回第二个操作数:

```js
let options = { timeout: o, title: "", verbose: false, n: null };
options.timeout ?? 1000; // => 0: 在对象中有定义
options.title ?? "Untitled"; // => "":在对象中有定义
options.verbose ?? true; // => false:在对象中有定义
options.quiet ?? false; // => false:属性没有定义
options.n ?? 10; // => 10：属性值为 null
```

??操作符与&&和||操作符类似，但优先级并不比它们更高或更 低。如果表达式中混用了??和它们中的任何一个，必须使用圆括号说明先执行哪个操作:

```js
(a ?? b) || c; // ?? 先执行，然后执行 ||
a ?? (b || c); // || 先抽行，然后执行 ??
a ?? b || c; // SyntaxError: 必须有圆括号
```

??操作符是ES2020定义的，在2020年初已经得到所有主流浏览器当前和预览版的支持。这个操作符正式的名字叫“缺值合并” (nullish coalescing)操作符。

## typeof 操作符

typeof操作符的值是一个字符串，表明操作数的类型。

![image-20240114172848837](https://qiniucloud.qishilong.space/images/image-20240114172848837.png)

注意，如果操作数的值是null，typeof返回“object”。如果 想区分null和对象，必须显式测试这个特殊值。

因为对除函数之外的所有对象和数组值，typeof都求值为 “object”，所以可以只用它来区分对象和其他原始类型。而要区 分不同对象的类，必须使用其他方法，例如instanceof操作符、class特性，或者constructor属性。

## delete 操作符

delete是一元操作符，尝试删除其操作数指定的对象属性或数组元素。

注意，被删除的属性或数组元素不仅会被设置为undefined值。 当删除一个属性时，这个属性就不复存在了。尝试读取不存在的属性会返回undefined，但可以通过in操作符测试某个属性是否存在。删除某个数组元素会在数组中留下一个“坑”，并 不改变数组的长度。结果数组是一个稀疏数组。

delete期待它的操作数是个左值。如果操作数不是左值， delete什么也不做，且返回true。否则，delete尝试删除指定的左 值。如果删除成功则返回true。但是并非所有属性都是可以删除的：**不可配置属性就无法删除**。

在严格模式下，delete的操作数如果是未限定标识符，比如变 量、函数或函数参数，就会导致SyntaxError。此时，delete操作符 只能作用于属性访问表达式。严格模式也会在delete 尝试删除不可配置(即不可删除)属性时抛出TypeError。但在严格 模式之外，这两种情况都不会发生异常，delete只是简单地返回 false，表示不能删除操作数。

下面是几个使用delete操作符的例子：

```js
let o = { x: 1, y: 2 };
delete o.x; //删除对象的一个属性；返回true
typeof o.x; // 属性不存在；返回 "undefined"
delete o.x; //刑除不存在的属性；返回 true
delete 1; //这样做毫无意义，但会返回 true
delete o; //不能删除变量：返回 false，或在严格模式下报 SyntaxError
delete Object.prototype; //不可删除的属性：返回 false，或在严格模式下报 TypeError
```

## await 操作符

## void 操作符

void是一元操作符，出现在它的操作数前面，这个操作数可以 是任意类型。void是个与众不同的操作符，用处不多:它求值自己的操作数，然后丢弃这个值并返回undefined。由于操作数的值会被丢弃，只有在操作数有副效应时才有必要使用void操作符。

void操作符太难解释，也很难给出一个实际的例子说明它的用法。一种情况是你要定义一个函数，这个函数什么也不返回，但却使用了箭头函数的简写语法，其中函数体是一个会 被求值并返回的表达式。如果你只想对这个表达式求值，不想返回它的值，那最简单的方法是用花括号把函数体包起来。此时，作为替代也可以使用void操作符：

```js
let counter = 0;
const increment = () => void counter++;
increment(); // => undefined
counter; // => 1
```

## 逗号操作符 ,

逗号操作符是二元操作符，其操作数可以是任意类型。这个操作符会求值其左操作数，求值其右操作数，然后返回右操作数的值。因此，下面这行代码：

```js
i = 0, j = 1, k = 2;
```

求值为2，基本上等价于：

```js
i = 0; j = 1; k = 2;
```

换句话说，逗号左侧的操作数始终会被求值，但这个值会被丢弃。而这也意味着只有当左侧表达式有副效应时才有必要使用逗号操作符。逗号操作符唯一常见的使用场景就是有多个循环变量的 for 循环：

```js
// 下面第一个逗号是 let 语句语法的一部分
// 第二个逗号是逗号操作符，它让我们把两个表达式（i++ 与 j--）
// 放到了本来期待一个表达式的语句(for循环)中
for (let i = 0, j = 10; i < j; i++, j--) {
  console.log(i + j);
}
```

